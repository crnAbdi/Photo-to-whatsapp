
<!DOCTYPE html>
<html>
<head>
    <title>Auto-Send Photo</title>
    <style>
        /* Add your CSS styling here */
    </style>
</head>
<body>
    <h1>Take a Photo</h1>
    <video id="video" autoplay></video>
    <button id="captureBtn">Capture Photo</button>
    <canvas id="canvas" style="display:none;"></canvas>
    <div id="status"></div>

  <script>
  const video = document.getElementById('video');
  const canvas = document.getElementById('canvas');
  const ctx = canvas.getContext('2d');
  const captureBtn = document.getElementById('captureBtn');
  const statusDiv = document.getElementById('status');
  const scriptUrl = 'https://script.google.com/macros/s/AKfycbzsZg4zDWlXRD4eDi_D3hTQ7kD-2R4ef6wUuc47OM3BSOWsp56uC5cI8qq5PUNiYDw7Jw/exec';

  // Access camera
  navigator.mediaDevices.getUserMedia({ video: true })
    .then(stream => {
      video.srcObject = stream;
      video.onloadedmetadata = () => {
        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;
      };
    })
    .catch(err => {
      statusDiv.textContent = 'Camera error: ' + err.message;
    });

  // Capture and upload photo
  captureBtn.addEventListener('click', async () => {
    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
    video.srcObject.getTracks().forEach(track => track.stop());

    // Extract Base64 data
    const base64Data = canvas.toDataURL('image/jpeg').split(',')[1];

    // Upload to Google Drive
    statusDiv.textContent = 'Uploading...';
    try {
      const response = await fetch(scriptUrl, {
        method: 'POST',
        headers: { 'Content-Type': 'text/plain' },
        body: base64Data
      });
      
      if (!response.ok) throw new Error('Server error');
      
      const imageUrl = await response.text();
      const phoneNumber = '252636833166';
      window.open(`https://wa.me/${phoneNumber}?text=Photo: ${encodeURIComponent(imageUrl)}`, '_blank');
    } catch (err) {
      statusDiv.textContent = 'Upload failed: ' + err.message;
      console.error('Error:', err);
    }
  });
</script>
</body>
</html>